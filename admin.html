<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Swami Studio - Admin Control</title>
    <style>
        body { background-color: #f4f4f4; font-family: 'Segoe UI', sans-serif; padding: 20px; color: #333; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 40px; border-radius: 12px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        
        h1 { color: #333; border-bottom: 3px solid #FF9900; display: inline-block; padding-bottom: 5px; }
        h2 { margin-top: 30px; color: #555; font-size: 1.2rem; background: #eee; padding: 10px; border-radius: 5px; }
        
        .form-group { margin-bottom: 20px; }
        label { display: block; font-weight: bold; margin-bottom: 8px; font-size: 0.9rem; }
        input, select, textarea { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 1rem; }
        input:focus { border-color: #FF9900; outline: none; }
        
        .grid-inputs { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        
        /* BUTTON STYLES */
        .main-btn {
            background-color: #FF9900; color: white; border: none; padding: 15px;
            font-size: 1.1rem; cursor: pointer; width: 100%; font-weight: bold; border-radius: 6px;
            transition: 0.3s;
        }
        .main-btn:hover { background-color: #cc7a00; }

        .update-btn { background-color: #007bff; } /* Blue for Update */
        .update-btn:hover { background-color: #0056b3; }

        .cancel-btn {
            background-color: #666; color: white; border: none; padding: 10px; 
            border-radius: 5px; cursor: pointer; display: none; margin-top: 10px; width: 100%;
        }

        /* LIST STYLES */
        .list-item { 
            background: #fff; border-bottom: 1px solid #eee; padding: 15px; 
            display: flex; justify-content: space-between; align-items: center;
        }
        .action-btns { display: flex; gap: 10px; }
        .delete-btn { background: #ff4444; color: white; border:none; padding: 5px 15px; cursor:pointer; border-radius:4px;}
        .edit-btn { background: #007bff; color: white; border:none; padding: 5px 15px; cursor:pointer; border-radius:4px;}
    </style>
</head>
<body>

<div class="container">
    <h1>Swami Studio Admin</h1>

    <h2>1. Website Logo</h2>
    <div class="form-group">
        <label>Logo Image URL</label>
        <input type="text" id="siteLogo" placeholder="Paste URL of your logo here">
    </div>
    <button class="main-btn" onclick="saveLogo()" style="background:#333;">Update Logo</button>

    <h2>2. Create Categories</h2>
    <div class="grid-inputs">
        <input type="text" id="newCatName" placeholder="New Category (e.g. Haldi, Wedding)">
        <button class="main-btn" onclick="addNewCategory()" style="padding: 10px;">+ Add</button>
    </div>
    <p style="font-size: 0.9rem; color: #666; margin-top: 5px;">Active: <span id="activeCats"></span></p>

    <h2 id="formTitle">3. Add New Package / Album</h2>
    
    <div class="form-group">
        <label>Select Category</label>
        <select id="category"></select>
    </div>

    <div class="form-group">
        <label>Package Title (Sub-Category)</label>
        <input type="text" id="title" placeholder="e.g. Rohan & Priya Wedding / Gold Package">
    </div>

    <div class="form-group">
        <label>Price (₹)</label>
        <input type="number" id="price" placeholder="e.g. 25000">
    </div>

    <div class="form-group">
        <label>Description</label>
        <textarea id="desc" rows="3" placeholder="Details about this package..."></textarea>
    </div>

    <div style="background: #fff8e1; padding: 15px; border-radius: 8px; border: 1px solid #ffe0b2; margin-bottom: 20px;">
        <label style="color: #FF9900;">Step 4: Upload Media (URLs)</label>
        
        <div class="form-group">
            <label>Main Cover Image (Required)</label>
            <input type="text" id="imgMain" placeholder="Main thumbnail image URL">
        </div>

        <div class="grid-inputs">
            <div><label>Extra 1</label><input type="text" class="extra-img" id="ex1" placeholder="Optional"></div>
            <div><label>Extra 2</label><input type="text" class="extra-img" id="ex2" placeholder="Optional"></div>
            <div><label>Extra 3</label><input type="text" class="extra-img" id="ex3" placeholder="Optional"></div>
            <div><label>Extra 4</label><input type="text" class="extra-img" id="ex4" placeholder="Optional"></div>
            <div><label>Extra 5</label><input type="text" class="extra-img" id="ex5" placeholder="Optional"></div>
            <div><label>Video URL</label><input type="text" id="vidUrl" placeholder="Optional Video Link"></div>
        </div>
    </div>

    <button id="submitBtn" class="main-btn" onclick="handlePackageSubmit()">PUBLISH PACKAGE</button>
    <button id="cancelBtn" class="cancel-btn" onclick="cancelEdit()">CANCEL EDIT</button>

    <h2>Manage Current Packages</h2>
    <div id="listContainer"></div>
</div>

<script>
    let editModeIndex = -1; // -1 means we are adding, otherwise we are editing

    // --- LOGO & CATEGORY LOGIC (Unchanged) ---
    function saveLogo() {
        const url = document.getElementById('siteLogo').value;
        if(url) { localStorage.setItem('swamiLogo', url); alert("Logo Updated!"); }
    }

    function loadCategories() {
        let cats = JSON.parse(localStorage.getItem('swamiCategories'));
        if (!cats) { cats = ['Wedding', 'Pre-Wedding', 'Maternity', 'Events']; localStorage.setItem('swamiCategories', JSON.stringify(cats)); }
        
        const select = document.getElementById('category');
        select.innerHTML = '';
        cats.forEach(c => {
            let opt = document.createElement('option');
            opt.value = c; opt.innerHTML = c; select.appendChild(opt);
        });
        document.getElementById('activeCats').innerText = cats.join(', ');
        
        const savedLogo = localStorage.getItem('swamiLogo');
        if(savedLogo) document.getElementById('siteLogo').value = savedLogo;
    }

    function addNewCategory() {
        const newCat = document.getElementById('newCatName').value.trim();
        if(!newCat) return;
        let cats = JSON.parse(localStorage.getItem('swamiCategories'));
        if(!cats.includes(newCat)) {
            cats.push(newCat);
            localStorage.setItem('swamiCategories', JSON.stringify(cats));
            loadCategories();
            document.getElementById('newCatName').value = '';
        }
    }

    // --- PACKAGE LOGIC (UPDATED FOR EDITING) ---
    
    // 1. Decides whether to Add or Update
    function handlePackageSubmit() {
        const extras = [];
        document.querySelectorAll('.extra-img').forEach(input => {
            if(input.value.trim()) extras.push(input.value.trim());
        });

        const newItem = {
            id: Date.now(),
            category: document.getElementById('category').value,
            title: document.getElementById('title').value,
            price: document.getElementById('price').value,
            desc: document.getElementById('desc').value,
            mainImg: document.getElementById('imgMain').value,
            extraImgs: extras,
            video: document.getElementById('vidUrl').value
        };

        if(!newItem.title || !newItem.mainImg) {
            alert("Title and Main Image are required!");
            return;
        }

        let data = JSON.parse(localStorage.getItem('swamiDataPro')) || [];

        if (editModeIndex === -1) {
            // ADD NEW MODE
            data.push(newItem);
            alert("Package Published!");
        } else {
            // EDIT EXISTING MODE (Keep original ID)
            newItem.id = data[editModeIndex].id; 
            data[editModeIndex] = newItem;
            alert("Package Updated Successfully!");
            cancelEdit(); // Reset form
        }

        localStorage.setItem('swamiDataPro', JSON.stringify(data));
        loadItems();
        clearForm();
    }

    // 2. Load list with Edit Buttons
    function loadItems() {
        const data = JSON.parse(localStorage.getItem('swamiDataPro')) || [];
        const container = document.getElementById('listContainer');
        container.innerHTML = '';
        
        // We iterate normally so indices match
        data.forEach((item, index) => { 
            const div = document.createElement('div');
            div.className = 'list-item';
            div.innerHTML = `
                <div>
                    <strong>${item.category}</strong>: ${item.title} (₹${item.price})
                </div>
                <div class="action-btns">
                    <button class="edit-btn" onclick="editItem(${index})">Edit</button>
                    <button class="delete-btn" onclick="deleteItem(${index})">Delete</button>
                </div>
            `;
            container.appendChild(div);
        });
    }

    // 3. Enter Edit Mode
    function editItem(index) {
        let data = JSON.parse(localStorage.getItem('swamiDataPro')) || [];
        let item = data[index];

        editModeIndex = index; // Set the global index tracker

        // Fill form with data
        document.getElementById('category').value = item.category;
        document.getElementById('title').value = item.title;
        document.getElementById('price').value = item.price;
        document.getElementById('desc').value = item.desc;
        document.getElementById('imgMain').value = item.mainImg;
        document.getElementById('vidUrl').value = item.video || '';

        // Fill extras (up to 5)
        document.querySelectorAll('.extra-img').forEach(i => i.value = ''); // Clear first
        if(item.extraImgs) {
            item.extraImgs.forEach((img, i) => {
                if(i < 5) document.getElementById('ex'+(i+1)).value = img;
            });
        }

        // Change UI to Edit Mode
        document.getElementById('formTitle').innerText = "Edit Package: " + item.title;
        document.getElementById('formTitle').style.color = "#007bff";
        
        const btn = document.getElementById('submitBtn');
        btn.innerText = "UPDATE PACKAGE";
        btn.classList.add('update-btn');
        
        document.getElementById('cancelBtn').style.display = "block";

        // Scroll to top
        window.scrollTo(0, 0);
    }

    // 4. Cancel Edit
    function cancelEdit() {
        editModeIndex = -1;
        clearForm();
        
        // Reset UI
        document.getElementById('formTitle').innerText = "3. Add New Package / Album";
        document.getElementById('formTitle').style.color = "#555";
        
        const btn = document.getElementById('submitBtn');
        btn.innerText = "PUBLISH PACKAGE";
        btn.classList.remove('update-btn');
        
        document.getElementById('cancelBtn').style.display = "none";
    }

    function clearForm() {
        document.getElementById('title').value = '';
        document.getElementById('price').value = '';
        document.getElementById('desc').value = '';
        document.getElementById('imgMain').value = '';
        document.getElementById('vidUrl').value = '';
        document.querySelectorAll('.extra-img').forEach(i => i.value = '');
    }

    function deleteItem(index) {
        if(confirm("Are you sure you want to delete this?")) {
            let data = JSON.parse(localStorage.getItem('swamiDataPro')) || [];
            data.splice(index, 1);
            localStorage.setItem('swamiDataPro', JSON.stringify(data));
            loadItems();
            if(index === editModeIndex) cancelEdit(); // If we deleted what we were editing
        }
    }

    window.onload = function() { loadCategories(); loadItems(); };
</script>

</body>
</html>
